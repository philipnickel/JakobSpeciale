
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "example_gallery/example_integration/plot_integration.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_example_gallery_example_integration_plot_integration.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_example_gallery_example_integration_plot_integration.py:


Visualize Integration Results
==============================

Plot convergence of numerical integration methods.

.. GENERATED FROM PYTHON SOURCE LINES 9-17

.. code-block:: Python

    from pathlib import Path

    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd

    from numutils.utils import setup_plotting








.. GENERATED FROM PYTHON SOURCE LINES 18-43

.. code-block:: Python

    setup_plotting()

    # Try to find data file (handles both normal execution and sphinx-gallery builds)
    data_file = None
    for base_path in [Path("."), Path("../.."), Path("../../..")]:
        candidate = base_path / "data/example_integration/integration_results.parquet"
        if candidate.exists():
            data_file = candidate
            break

    if data_file is None:
        import sys
        print("Warning: Data file not found. Run compute.py first.")
        sys.exit(0)

    fig_dir = Path("docs/source/generated/figures")
    for base_path in [Path("."), Path("../.."), Path("../../..")]:
        candidate = base_path / "docs/source/generated/figures"
        try:
            candidate.mkdir(parents=True, exist_ok=True)
            fig_dir = candidate
            break
        except (PermissionError, OSError):
            continue








.. GENERATED FROM PYTHON SOURCE LINES 44-46

.. code-block:: Python

    df = pd.read_parquet(data_file)








.. GENERATED FROM PYTHON SOURCE LINES 47-75

.. code-block:: Python

    functions = df["function"].unique()

    fig, axes = plt.subplots(1, 3, figsize=(12, 4))

    for i, func_name in enumerate(functions):
        ax = axes[i]
        func_data = df[df["function"] == func_name]

        for method in ["Trapezoidal", "Simpson"]:
            method_data = func_data[func_data["method"] == method]
            ax.loglog(
                method_data["N"],
                method_data["error"],
                "o-",
                label=method,
                markersize=4,
            )

        ax.set_xlabel("Number of intervals (N)")
        ax.set_ylabel("Absolute error")
        ax.set_title(func_name)
        ax.legend()
        ax.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig(fig_dir / "integration_convergence.png", dpi=300, bbox_inches="tight")
    print(f"Saved figure to {fig_dir}/integration_convergence.png")




.. image-sg:: /example_gallery/example_integration/images/sphx_glr_plot_integration_001.png
   :alt: $x^2$ from 0 to 1, $\sin(x)$ from 0 to $\pi$, $e^{-x}$ from 0 to 2
   :srcset: /example_gallery/example_integration/images/sphx_glr_plot_integration_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Saved figure to docs/source/generated/figures/integration_convergence.png




.. GENERATED FROM PYTHON SOURCE LINES 76-93

.. code-block:: Python

    print("\nConvergence rates (log-log slope):")
    for func_name in functions:
        print(f"\n{func_name}:")
        func_data = df[df["function"] == func_name]

        for method in ["Trapezoidal", "Simpson"]:
            method_data = func_data[func_data["method"] == method].sort_values("N")
            N_vals = method_data["N"].values
            errors = method_data["error"].values

            # Compute slope in log-log space (last 3 points)
            if len(N_vals) >= 3:
                log_N = np.log(N_vals[-3:])
                log_err = np.log(errors[-3:])
                slope = (log_err[-1] - log_err[0]) / (log_N[-1] - log_N[0])
                print(f"  {method}: {slope:.2f}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Convergence rates (log-log slope):

    $x^2$ from 0 to 1:
      Trapezoidal: -2.00
      Simpson: 0.00

    $\sin(x)$ from 0 to $\pi$:
      Trapezoidal: -2.00
      Simpson: -4.00

    $e^{-x}$ from 0 to 2:
      Trapezoidal: -2.00
      Simpson: -4.00





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 3.855 seconds)


.. _sphx_glr_download_example_gallery_example_integration_plot_integration.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_integration.ipynb <plot_integration.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_integration.py <plot_integration.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_integration.zip <plot_integration.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
